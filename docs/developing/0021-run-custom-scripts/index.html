<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-developing/0021-run-custom-scripts" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Run Custom Scripts with Virtual Client | Virtual Client Platform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://microsoft.github.io/VirtualClient/docs/developing/0021-run-custom-scripts/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="performance, benchmarking, automation, framework, microsoft"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Run Custom Scripts with Virtual Client | Virtual Client Platform"><meta data-rh="true" name="description" content="The following section covers the steps to use custom scripts and test suites with Virtual Client, by just authoring custom profiles, thereby"><meta data-rh="true" property="og:description" content="The following section covers the steps to use custom scripts and test suites with Virtual Client, by just authoring custom profiles, thereby"><link data-rh="true" rel="icon" href="/VirtualClient/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://microsoft.github.io/VirtualClient/docs/developing/0021-run-custom-scripts/"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/VirtualClient/docs/developing/0021-run-custom-scripts/" hreflang="en"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/VirtualClient/docs/developing/0021-run-custom-scripts/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0I7D8A07MA-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/VirtualClient/blog/rss.xml" title="Virtual Client Platform RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/VirtualClient/blog/atom.xml" title="Virtual Client Platform Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Virtual Client Platform" href="/VirtualClient/opensearch.xml"><link rel="stylesheet" href="/VirtualClient/assets/css/styles.9af2558c.css">
<script src="/VirtualClient/assets/js/runtime~main.f5e3bc80.js" defer="defer"></script>
<script src="/VirtualClient/assets/js/main.5ee6f4a4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like VirtualClient, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/microsoft/VirtualClient">GitHub</a> ⭐️</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/VirtualClient/"><div class="navbar__logo"><img src="/VirtualClient/img/vc-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/VirtualClient/img/vc-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Virtual Client</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/VirtualClient/docs/overview/">Documentation</a><a class="navbar__item navbar__link" href="/VirtualClient/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/VirtualClient" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/overview/">Overview</a><button aria-label="Expand sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/guides/">Guides</a><button aria-label="Expand sidebar category &#x27;Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/workloads/">Workloads</a><button aria-label="Expand sidebar category &#x27;Workloads&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/monitors/">Monitors</a><button aria-label="Expand sidebar category &#x27;Monitors&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/dependencies/">Dependencies</a><button aria-label="Expand sidebar category &#x27;Dependencies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/VirtualClient/docs/category/developing/">Developing</a><button aria-label="Collapse sidebar category &#x27;Developing&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0001-ci-cd/">Automated Build and CI/CD pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0010-develop-guide/">Developer Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0020-develop-extensions/">Developing Extensions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/VirtualClient/docs/developing/0021-run-custom-scripts/">Run Custom Scripts with Virtual Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0030-workload-onboarding/">Workload Onboarding Process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0040-vc-packages/">VC Packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0050-develop-profiling-monitor/">Profiler Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0060-workload-recommendations/">Workload Selection Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0061-build-docker-container/">Building Docker Containers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0070-error-handling/">Error Handling Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0080-coding-standards/">Coding Standards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0090-testing/">Testing Practices</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/VirtualClient/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/VirtualClient/docs/category/developing/"><span itemprop="name">Developing</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Run Custom Scripts with Virtual Client</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1 id="run-custom-scripts-with-virtual-client">Run Custom Scripts with Virtual Client</h1>
<p>The following section covers the steps to use custom scripts and test suites with Virtual Client, by just authoring custom profiles, thereby
without any code change in Virtual Client. Virtual Client provides multiple &quot;Action&quot; components that can be used to build a custom profile
and run any script/test-suite. Virtual Client would have some expectations from the custom script/test-suite in terms of folder
structure for the script, logging and metrics parsing, which are covered in subsequent sections.</p>
<p>The document includes an example in the last section that shows the end to end steps of running a custom script/test-suite
with Virtual Client.</p>
<h2 id="execution-and-logging-requirements-with-the-test-suitescript">Execution and Logging Requirements with the Test Suite/Script</h2>
<ul>
<li>
<p><strong>Directory Structure</strong>
The script/test-suite, when being executed through Virtula Client would be expected to follow a standard directory structure that
is used by all VC Workloads. VC supports four OS-platforms (win-x64, linux-x64, win-arm64 and linux-arm64). The script/test suites
should be placed in the suitabe directory. These will then be zipped to form the wokrload package, and can be uploaded on blob
package store, if the DownloadDependencyProvider needs to be used to download the package during VC Execution.</p>
<ul>
<li>Example directory structure:<!-- -->
<pre><code>- workloadPackage 
  - linux-arm64
    - &lt;linux-arm64 based scripts&gt;
  - linux-x64
    - &lt;linux-x64 based scripts&gt;
  - win-x64
    - &lt;win-x64 based scripts&gt;
  - win-arm64
    - &lt;win-arm64 based scripts&gt;
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Logging Requirements</strong>
All the execution logs that need to captured/uploaded to content Store, need to be provided as a parameter to the Action Component
(Refer to examples in below sections). The parameter supports logs in a sub-folder within the workload package, or string pattern
of respective log files.</p>
</li>
<li>
<p><strong>Capturing Metrics</strong>
If the metrics are required to be captured for the test execution and sent to telemetry, then the script/tool would be expected to
have a parser that parses the required metrics from it’s logs and have them enumerated in a standard metrics JSON file
(called test-metrics.json) within the workload package folder. Virtual Client would be capturing the metrics from the JSON and
using it to process further for sending it over telemetry and attaching required metadata to it.</p>
<ul>
<li>Example test-metrics.json file:<!-- -->
<pre><code class="language-json">{
    &quot;metric1&quot;: &quot;0&quot;,
    &quot;metric2&quot;: &quot;1.45&quot;,
    &quot;metric3&quot;: &quot;1279854282929.09&quot;
}
</code></pre>
</li>
</ul>
</li>
</ul>
<h2 id="generic-executor-components-for-scripts">Generic Executor Components for Scripts</h2>
<p><a href="https://github.com/microsoft/VirtualClient/blob/main/src/VirtualClient/VirtualClient.Main/profiles/EXAMPLE-EXECUTE-SCRIPT.json">Example Profile</a></p>
<p>The following executor Components can be used to build profiles for executing the custom scripts and test-suites in Virtual Client.</p>
<ul>
<li>
<p><strong>ScriptExecutor</strong>
This Action can be used to execute bash, cmd, bat, shell scripts and executables.</p>
<pre><code class="language-json">Example:
&quot;Actions&quot;: [
    {
        &quot;Type&quot;: &quot;ScriptExecutor&quot;,
        &quot;Parameters&quot;: {
            &quot;Scenario&quot;: &quot;Name_Of_Scenario&quot;,
            &quot;CommandLine&quot;: &quot;argument1 argument2&quot;,
            &quot;ScriptPath&quot;: &quot;script.sh&quot;,
            &quot;LogPaths&quot;:  &quot;*.log;*.txt;logSubFolder\\&quot;,
            &quot;ToolName&quot;:  &quot;Name_Of_Tool&quot;,
            &quot;PackageName&quot;:  &quot;exampleWorkload&quot;,
            &quot;FailFast&quot;:  false,
            &quot;Tags&quot;: &quot;Test,VC,Script&quot;
        }
    }
]
</code></pre>
</li>
<li>
<p><strong>PowershellExecutor</strong>
This Action can be used to execute Powershell Scripts in Windows.</p>
</li>
<li>
<p>Please note Virtual Client should be run in elevated mode when using this component, as it sets the execution Policy to be bypass.</p>
<pre><code class="language-json">Example:
&quot;Actions&quot;: [
    {
        &quot;Type&quot;: &quot;PowershellExecutor&quot;,
        &quot;Parameters&quot;: {
            &quot;Scenario&quot;: &quot;Name_Of_Scenario&quot;,
            &quot;CommandLine&quot;: &quot;argument1 argument2&quot;,
            &quot;ScriptPath&quot;: &quot;script.ps1&quot;,
            &quot;LogPaths&quot;:  &quot;*.log;*.txt;logSubFolder\\&quot;,
            &quot;ToolName&quot;:  &quot;Name_Of_Tool&quot;,
            &quot;PackageName&quot;:  &quot;exampleWorkload&quot;,
            &quot;FailFast&quot;:  false,
            &quot;Tags&quot;: &quot;Test,VC,Script&quot;
        }
    }
]
</code></pre>
</li>
<li>
<p><strong>PythonExecutor</strong>
This Action can be used to execute Python Scripts in Windows and Linux. The Dependency Components in Virtual Client can be used to
install python on the system. The following example shows the dependency components for Linux and Windows, one of them can be used
as per the platform.</p>
<pre><code class="language-json">Example:
&quot;Actions&quot;: [
    {
        &quot;Type&quot;: &quot;PythonExecutor&quot;,
        &quot;Parameters&quot;: {
            &quot;Scenario&quot;: &quot;Name_Of_Scenario&quot;,
            &quot;CommandLine&quot;: &quot;argument1 argument2&quot;,
            &quot;ScriptPath&quot;: &quot;script.py&quot;,
            &quot;LogPaths&quot;:  &quot;*.log;*.txt;logSubFolder\\&quot;,
            &quot;ToolName&quot;:  &quot;Name_Of_Tool&quot;,
            &quot;PackageName&quot;:  &quot;exampleWorkload&quot;,
            &quot;UsePython3&quot;: true,
            &quot;FailFast&quot;:  false,
            &quot;Tags&quot;: &quot;Test,VC,Script&quot;
        }
    }
]

Python installation in Linux:
&quot;Dependencies&quot;: [
    {
        &quot;Type&quot;: &quot;LinuxPackageInstallation&quot;,
        &quot;Parameters&quot;: {
            &quot;Scenario&quot;: &quot;InstallLinuxPackages&quot;,
            &quot;Packages&quot;: &quot;python3,python3-pip&quot;
        }
    }
]

Python Installation in Windows using chocolatey
&quot;Dependencies&quot;: [
    {
        &quot;Type&quot;: &quot;ChocolateyInstallation&quot;,
        &quot;Parameters&quot;: {
            &quot;Scenario&quot;: &quot;InstallChocolatey&quot;,
            &quot;PackageName&quot;: &quot;chocolatey&quot;
        }
    },
    {
        &quot;Type&quot;: &quot;ChocolateyPackageInstallation&quot;,
        &quot;Parameters&quot;: {
            &quot;Scenario&quot;: &quot;InstallCygwin&quot;,
            &quot;PackageName&quot;: &quot;chocolatey&quot;,
            &quot;Packages&quot;: &quot;python3&quot;
        }
    }
]
</code></pre>
</li>
</ul>
<h2 id="profile-parameters">Profile Parameters</h2>
<p>The following parameters are supported by the Executor Classes that can be modified in a custom profile to run the scripts.</p>
<table><thead><tr><th>Parameter</th><th>Purpose</th><th>Acceptable Type</th></tr></thead><tbody><tr><td>Scenario</td><td>Name of the scenario</td><td>String</td></tr><tr><td>ToolName</td><td>Name of the Script/Tool being executed</td><td>String</td></tr><tr><td>CommandLine</td><td>The command line arguments to be used with the script/executable</td><td>String</td></tr><tr><td>ScriptPath</td><td>Relative Path of the script inside the workload package that needs to be invoked.</td><td>String</td></tr><tr><td>LogPaths</td><td>A list of file/folder paths separated by semicolons &quot;;&quot;. Refer to the Logging Section for more info.</td><td>String (List of Log files/folders separted by semicolon)</td></tr><tr><td>PackageName</td><td>Name of the workload package built for running the script. If the workload package is being downloaded from blob package store, this needs to match with the package name defined in DependencyPackageInstallation.</td><td>String</td></tr><tr><td>FailFast</td><td>Flag indicates that the application should exit immediately on first/any errors regardless of their severity.</td><td>Boolean</td></tr><tr><td>UsePython3</td><td>(Only valid for PythonExecutor) A true value indicates use of &quot;python3&quot; as environment variable to execute python, a false value will use &quot;python&quot; as the environment variable.</td><td>Boolean (Default is true)</td></tr></tbody></table>
<h2 id="logging-and-metrics">Logging and Metrics</h2>
<ul>
<li>
<h3 id="logging">Logging</h3>
<p>The “LogPaths” parameter of the generic executor determines the semicolon &quot;;&quot; separated logs sub-folders and log files.</p>
<ul>
<li>
<p>For the sub-folder, the relative path to the sub-folder within the package directory needs to be provided.
Then all files within the directory will be swept, and they will be uploaded to content store (if the contentstore --cs parameter
is provided in Virtual Client) and will be moved to the central logs directory in Virtual Client.</p>
</li>
<li>
<p>For the filePaths, each relative file path can be a pattern that will be matched within the workload Package directory. For example,
a pattern of *.txt will cover all txt files within the workload package directory and they will be swept, uploaded to content
store (if contentStore --cs parameter is provided) and will be moved to central logs directory.</p>
</li>
</ul>
<p>Example Central Logs Directory (for a win-x64 system):
(VirtualClient root folder) &gt; content &gt; win-x64 &gt; logs &gt; toolName &gt; scenarioName_TIMESTAMP</p>
</li>
<li>
<h3 id="metrics">Metrics</h3>
<p>The metrics capturing for the script/test-suite by Virtual Client would depend on the metric Parsing requirement. The script/test-suite
would be expected to parse the required metrics and save it in a json format in a file called &quot;test-metrics.json&quot;,
saved in the workload package root folder. Thus, the actual metric parsing logic here is a responsibility of the test suite/script.
It will be expected to generate a metrics json file with key-value pairs, where each key represents a metric name and the
value is the metric Value. Virtual Client will capture these metrics and will be sending it to telemetry for further actions.</p>
</li>
</ul>
<h2 id="example-custom-profile">Example Custom Profile</h2>
<h4 id="pre-reads">Pre-Reads:</h4>
<ul>
<li><a href="https://microsoft.github.io/VirtualClient/docs/guides/0011-profiles/">Virtual Client Profiles</a>: Learn about profiles in Virtual Client</li>
<li><a href="https://microsoft.github.io/VirtualClient/docs/developing/0010-develop-guide/">Virtual Client Developer Guide</a>: Refer to the &quot;Debug in Visual Studio by Running a Custom Profile&quot; Section to know more about developing Custom Profiles.</li>
<li><a href="https://microsoft.github.io/VirtualClient/docs/guides/0030-commercial-workloads/">Virtual Client Workload Package</a>: Learn about creating workload packages and using it with DependencyPackageInstallation</li>
</ul>
<h4 id="example">Example</h4>
<p>Let us consider an example where a script called stress-memory is to be used with Virtual Client. There are two versions of the script
for Windows and Linux, stress-memory.cmd and stress-memory.sh respectively. The same binaries are for x64 and arm64 platforms.
They take an argument for timeout (-t) with value in seconds and -v is to be added for verbose logging.</p>
<p>They produce multiple log files</p>
<ul>
<li>traces-TIMESTAMP.txt is produced in a folder called &quot;traces&quot;</li>
<li>summary-TIMESTAMP.txt is produced in the root folder.</li>
<li>There are two configuration files called config-1.json and config-2.json, both in the root folder.</li>
<li>Also, the scripts parse the logs and generate metrics and store it in a file test-metrics.json in the root folder.</li>
</ul>
<p>All the 5 files are to be captured for logging.</p>
<p>The Steps to followed for above example are:</p>
<ol>
<li>
<p>Build a workload package for the scripts. The following directory structure for the zipped package can be followed:</p>
<pre><code>- stressmemory.1.0.zip 
   - linux-arm64
     - stress-memory.sh
   - linux-x64
     - stress-memory.sh
   - win-x64
     - stress-memory.cmd
   - win-arm64
     - stress-memory.cmd
</code></pre>
</li>
<li>
<p>The stressmemory.1.0.zip should be uploaded to the package store for downloading the workload package during execution.</p>
</li>
<li>
<p>A custom profile <code>(EXAMPLE-CUSTOM-PROFILE.json)</code> needs to be authored and needs to be placed in the respective &quot;profiles&quot; directory.</p>
<p>Custom Profile for above example (win-x64)</p>
<pre><code class="language-json">    {
       &quot;Description&quot;: &quot;Memory Stress Script Executor&quot;,
       &quot;MinimumExecutionInterval&quot;: &quot;00:10:00&quot;,
       &quot;Metadata&quot;: {
           &quot;SupportedPlatforms&quot;: &quot;win-x64,win-arm64&quot;
       },
       &quot;Parameters&quot;: {
           &quot;CommandLine&quot;: &quot;-t 600 -v&quot;,
           &quot;ScriptPath&quot;: &quot;stress-memory.cmd&quot;,
           &quot;LogPaths&quot;:  &quot;traces\\;summary-*.txt;*.json&quot;,
           &quot;ToolName&quot;:  &quot;stressscript&quot;,
           &quot;PackageName&quot;:  &quot;stresspackage&quot;,
           &quot;FailFast&quot;:  false
       },
       &quot;Actions&quot;: [
           {
               &quot;Type&quot;: &quot;ScriptExecutor&quot;,
               &quot;Parameters&quot;: {
                   &quot;Scenario&quot;: &quot;memory_stress_scenario&quot;,
                   &quot;CommandLine&quot;: &quot;$.Parameters.CommandLine&quot;,
                   &quot;ScriptPath&quot;: &quot;$.Parameters.ScriptPath&quot;,
                   &quot;LogPaths&quot;: &quot;$.Parameters.LogPaths&quot;,
                   &quot;ToolName&quot;: &quot;$.Parameters.ToolName&quot;,
                   &quot;PackageName&quot;: &quot;$.Parameters.PackageName&quot;,
                   &quot;FailFast&quot;:  &quot;$.Parameters.FailFast&quot;,
                   &quot;Tags&quot;: &quot;Test,VC,Script&quot;
               }
           }
       ],
       &quot;Dependencies&quot;: [
           {
               &quot;Type&quot;: &quot;DependencyPackageInstallation&quot;,
               &quot;Parameters&quot;: {
                   &quot;Scenario&quot;: &quot;InstallWorkloadPackage&quot;,
                   &quot;BlobContainer&quot;: &quot;packages&quot;,
                   &quot;BlobName&quot;: &quot;stressmemory.1.0.zip&quot;,
                   &quot;PackageName&quot;: &quot;$.Parameters.PackageName&quot;,
                   &quot;Extract&quot;: true
               }
           }
       ]
   }
</code></pre>
</li>
<li>
<p>The Virtual Client can be executed with the following command (assuming win-x64):
<code>VirtualClient.exe --profile=EXAMPLE-CUSTOM-PROFILE.json --packages=&quot;https://virtualclient...&quot; --debug --i=1</code></p>
</li>
<li>
<p>Once the execution is complete,</p>
<ul>
<li>The metrics would be available at:
<code>&lt;VirtualClientRootFolder&gt;\content\win-x64\logs\metrics.csv</code></li>
<li>The 5 files that were required to be captured, would be availabe at:
<code>&lt;VirtualClientRootFolder&gt;\content\win-x64\logs\stressscript\memory_stress_scenario_yyyyMMddHHmmss\</code></li>
</ul>
</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/VirtualClient/edit/main/website/docs/developing/0021-run-custom-scripts.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/VirtualClient/docs/developing/0020-develop-extensions/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Developing Extensions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/VirtualClient/docs/developing/0030-workload-onboarding/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Workload Onboarding Process</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#execution-and-logging-requirements-with-the-test-suitescript" class="table-of-contents__link toc-highlight">Execution and Logging Requirements with the Test Suite/Script</a></li><li><a href="#generic-executor-components-for-scripts" class="table-of-contents__link toc-highlight">Generic Executor Components for Scripts</a></li><li><a href="#profile-parameters" class="table-of-contents__link toc-highlight">Profile Parameters</a></li><li><a href="#logging-and-metrics" class="table-of-contents__link toc-highlight">Logging and Metrics</a><ul><li><a href="#logging" class="table-of-contents__link toc-highlight">Logging</a></li><li><a href="#metrics" class="table-of-contents__link toc-highlight">Metrics</a></li></ul></li><li><a href="#example-custom-profile" class="table-of-contents__link toc-highlight">Example Custom Profile</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/VirtualClient/docs/overview/">Overview</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/microsoft/VirtualClient/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussion<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/VirtualClient/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/microsoft/VirtualClient" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://microsoft.com/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/VirtualClient/img/microsoft-logo-white-text.svg" alt="MSFT Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/VirtualClient/img/microsoft-logo-white-text.svg" alt="MSFT Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">Copyright © 2024 Microsoft.</div></div></div></footer></div>
</body>
</html>
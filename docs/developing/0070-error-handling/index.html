<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-developing/0070-error-handling" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Error Handling Recommendations | Virtual Client Platform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://microsoft.github.io/VirtualClient/docs/developing/0070-error-handling/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="performance, benchmarking, automation, framework, microsoft"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Error Handling Recommendations | Virtual Client Platform"><meta data-rh="true" name="description" content="The following sections describe important details and recommendations for handling errors/exceptions in the operations of the"><meta data-rh="true" property="og:description" content="The following sections describe important details and recommendations for handling errors/exceptions in the operations of the"><link data-rh="true" rel="icon" href="/VirtualClient/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://microsoft.github.io/VirtualClient/docs/developing/0070-error-handling/"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/VirtualClient/docs/developing/0070-error-handling/" hreflang="en"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/VirtualClient/docs/developing/0070-error-handling/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0I7D8A07MA-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/VirtualClient/blog/rss.xml" title="Virtual Client Platform RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/VirtualClient/blog/atom.xml" title="Virtual Client Platform Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Virtual Client Platform" href="/VirtualClient/opensearch.xml"><link rel="stylesheet" href="/VirtualClient/assets/css/styles.9af2558c.css">
<script src="/VirtualClient/assets/js/runtime~main.509a511e.js" defer="defer"></script>
<script src="/VirtualClient/assets/js/main.cea975e9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like VirtualClient, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/microsoft/VirtualClient">GitHub</a> ⭐️</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/VirtualClient/"><div class="navbar__logo"><img src="/VirtualClient/img/vc-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/VirtualClient/img/vc-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Virtual Client</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/VirtualClient/docs/overview/">Documentation</a><a class="navbar__item navbar__link" href="/VirtualClient/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/VirtualClient" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/overview/">Overview</a><button aria-label="Expand sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/guides/">Guides</a><button aria-label="Expand sidebar category &#x27;Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/workloads/">Workloads</a><button aria-label="Expand sidebar category &#x27;Workloads&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/monitors/">Monitors</a><button aria-label="Expand sidebar category &#x27;Monitors&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/dependencies/">Dependencies</a><button aria-label="Expand sidebar category &#x27;Dependencies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/VirtualClient/docs/category/developing/">Developing</a><button aria-label="Collapse sidebar category &#x27;Developing&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0001-ci-cd/">Automated Build and CI/CD pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0010-develop-guide/">Developer Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0020-develop-extensions/">Developing Extensions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0021-run-custom-scripts/">Run Custom Scripts with Virtual Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0030-workload-onboarding/">Workload Onboarding Process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0040-vc-packages/">VC Packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0050-develop-profiling-monitor/">Profiler Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0060-workload-recommendations/">Workload Selection Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0061-build-docker-container/">Building Docker Containers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/VirtualClient/docs/developing/0070-error-handling/">Error Handling Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0080-coding-standards/">Coding Standards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0090-testing/">Testing Practices</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/VirtualClient/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/VirtualClient/docs/category/developing/"><span itemprop="name">Developing</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Error Handling Recommendations</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1 id="error-handling-recommendations">Error Handling Recommendations</h1>
<p>The following sections describe important details and recommendations for handling errors/exceptions in the operations of the
Virtual Client runtime. Error handling is particularly important for the quality of a runtime platform where there are many moving
parts.</p>
<h2 id="virtualclientexception">VirtualClientException</h2>
<p>The Virtual Client platform/core contains a base class that is used for most exceptions that are explicitly raised/thrown in the application
named <strong>VirtualClientException</strong>. This exception class derives from the .NET framework &#x27;Exception&#x27; class and allows the developer to communicate
not only a description of the error but also a structured &quot;reason&quot; for the error. The profile execution logic makes determinations on the severity
of exceptions that are raised/thrown based on the data type of the exception as well as the error reason that is supplied.</p>
<ul>
<li><a href="https://github.com/microsoft/VirtualClient/blob/main/src/VirtualClient/VirtualClient.Contracts/Exceptions.cs">Custom Platform/Core Exceptions</a></li>
<li><a href="https://github.com/microsoft/VirtualClient/blob/main/src/VirtualClient/VirtualClient.Contracts/Enumerations.cs">Error Reasons</a></li>
<li><a href="https://github.com/microsoft/VirtualClient/blob/main/src/VirtualClient/VirtualClient.Core/ProfileExecutor.cs">Profile Execution Logic</a></li>
</ul>
<pre><code class="language-csharp">// Custom exception classes in the Virtual Client platform/core derive from the base VirtualClientException class. Each of the
// platform/core exception classes implement the same constructors for consisteny. The &#x27;ErrorReason&#x27; provided is an important distinction.
public class WorkloadException : VirtualClientException
{
    public WorkloadException()
        : base()
    {
    }

    public WorkloadException(string message)
        : base(message)
    {
    }

    public WorkloadException(string message, ErrorReason reason)
        : base(message, reason)
    {
    }

    public WorkloadException(string message, Exception innerException)
        : base(message, innerException)
    {
    }

    public WorkloadException(string message, Exception innerException, ErrorReason reason)
        : base(message, innerException, reason)
    {
    }
}

// Errors raised during the operations of the hosted REST API service.
throw new ApiException();

// Errors raised during the operations of a dependency installer/handler.
throw new DependencyException();

// Errors raised during the operations of a monitor.
throw new MonitorException();

// Errors raised during the operations of a workload/test.
throw new WorkloadException();

// Errors raised during the operations of parsing the results of a workload/test.
throw new WorkloadResultsException();
</code></pre>
<h2 id="exception-handling">Exception Handling</h2>
<p>Based upon the data type of the exception thrown as well as the &#x27;ErrorReason&#x27; (if it is one of the custom platform/core exceptions), the profile execution
logic makes a decision on whether to handle it or let the Virtual Client crash. Thus error handling in the Virtual Client is a fair amount methodical and there
are recommendations as to how exceptions should be handled and thrown/raised. The type and severity of exceptions that are raised are at the discretion of the
developer that implements them. The specifics of the nature of errors can only be known in the context of the component a developer implements. The developer
can communicate error handling intent to the profile execution that is relevant. There are recommendations in sections that follow.</p>
<p>The following sections explain some of the methodology around exception handling in the Virtual Client.</p>
<ul>
<li>
<p><strong>Exceptions that are not explicitly handled by the profile execution logic result in a crash</strong><br>
<!-- -->The profile execution logic handles a few different exception types. However, if an exception is not a part of that explicit list of exceptions, the Virtual Client
runtime application will crash.</p>
</li>
<li>
<p><strong>VirtualClientException instances with error reasons from 100 - 399 are considered transient</strong><br>
<!-- -->Exceptions with an ErrorReason value from 100 - 399 are considered transient and will be handled. Transient errors are those in which the
developer has indicated the error will very likely go away within a period of time and thus the runtime operations will begin succeeding as expected. Exceptions
of this type will not crash the Virtual Client. The profile execution logic will continue onward. For example, if a particular workload execution action in a
profile happened to fail, the profile execution logic would continue on to the next action.</p>
</li>
<li>
<p><strong>VirtualClientException instances with error reasons from 400 - 499 represent critical failures that cannot be confirmed as transient or not</strong><br>
<!-- -->Exceptions with an ErrorReason value from 400 - 499 represent highly disruptive failures to the operations of the Virtual Client. However, they may or may not be
transient. That determination is not clear. It is this distinction (the fact that we cannot know if it is transient) why the profile execution logic generally handles
exceptions of this type and continue onward.</p>
</li>
<li>
<p><strong>VirtualClientException instances with error reasons &gt;= 500 represent terminal/permanent failures</strong><br>
<!-- -->Exceptions with an ErrorReason value greater than or equal to 500 represent terminal failures. These are failures where it is generally know that the Virtual Client
could never recover from them. For example the user supplied the name of a profile on the command line that does not exist. In this case, the profile file does not exist
and thus the Virtual Client could never know what it was supposed to do. Exceptions of this type will crash the Virtual Client.</p>
</li>
</ul>
<h2 id="exception-handling-recommendations">Exception Handling Recommendations</h2>
<p>The following sections document recommendations for the developer to follow when implementing new components in the Virtual Client codebase.</p>
<ul>
<li>
<p><strong>Explicitly handle known exceptions</strong><br>
<!-- -->As a general rule, all known exceptions should be handled and dealt with appropriately. The developer should make a decision depending upon the type of exception
whether it should then be propagated further. Exceptions that are not handled in an individual component will almost always crash the Virtual Client application.
This is by design.</p>
</li>
<li>
<p><strong>Retry on transient errors</strong><br>
<!-- -->For many cases of transient errors, a simple set of retries is enough to recover. Retries on transient error situations can be one of the best ways to build
reliability into an application. The Virtual Client codebase leverages an open source .NET framework called &#x27;Polly&#x27; to implement retry handling logic in
a consistent manner. The framework is already a part of the Virtual Client platform/core projects and libraries.</p>
<ul>
<li><a href="http://www.thepollyproject.org/">Polly Transient Fault Handling Library</a></li>
</ul>
</li>
<li>
<p><strong>Always provide good context-specific information in exceptions raised/thrown</strong><br>
<!-- -->Regardless of the quality of a software application, errors will always occur given time and certain scenarios. Error handling is always a challenging thing to
do well in any application; however, one of the key most important things to ensure is that the information provided in an error/exception is clear. Few things
are worse than having to figure out why an application is failing and having very little information by which to do so. When developing components in the Virtual
Client codebase, take the time to provide good information in error messages. Provide any amount of context information that is available in the code at the point
of throwing the exception that would help another person (including users and folks that do not program) understand what has happened. Sometimes a quality error enables
a user to course-correct. Otherwise, the user will likely be reaching out to the team and making it the someone on your team&#x27;s problem instead. Lots of time is
wasted in this way.</p>
<pre><code class="language-csharp">try
{
    ...
}
catch (FileNotFoundException exc)
{
    // This is an example of an error which is not very good. What file was not found?!! There will likely be more
    // than 1 file involved in running a particular Virtual Client profile. Give the user some pertinent information
    // about the situation so that they might be able to do something intelligent about it.
    throw new WorkloadException(&quot;The file was not found.&quot;, exc);

    // This is an example of better error information. The user might be able to address this on his/her own without need
    // for extra assistance. That is more satisfying for the user (who can self-help) as well as for the team.
    throw new WorkloadException(
        $&quot;The expected script file &#x27;{scriptFile}&#x27; was not found in the workload package with the name &#x27;{this.PackageName}&#x27;. &quot; +
        $&quot;This script is used to parse the custom results from the workload.&quot;,
        exc);
}
</code></pre>
</li>
<li>
<p><strong>Define an appropriate &#x27;ErrorReason&#x27; when raising/throwing exceptions that indicate transient errors</strong><br>
<!-- -->If an exception is caught within a given component that is deemed to be transient (despite any retries attempted), the exception thrown should be one of the
types that derive from the &#x27;VirtualClientException&#x27; class. Additionally an appropriate &#x27;ErrorReason&#x27; should be supplied indicating the category and severity of
the error so that the profile execution logic can itself handle it appropriately. Transient error reasons are in the range of 100 - 399. If an appropriate reason
does not already exist on the &#x27;ErrorReason&#x27; enumeration, create one.</p>
<pre><code class="language-csharp">try
{
    ...
}
catch (FileNotFoundException exc)
{
    // ErrorReason.WorkloadResultsNotFound = 314

    throw new WorkloadException(
      $&quot;The &#x27;{workloadName}&#x27; workload experienced an issue writing the results file to the system.&quot;,
      exc,
      ErrorReason.WorkloadResultsNotFound);
}
</code></pre>
</li>
<li>
<p><strong>Define an appropriate &#x27;ErrorReason&#x27; when raising/throwing exceptions that indicate terminal/permanent errors</strong><br>
<!-- -->If an exception is caught within a given component that is deemed to be transient (despite any retries attempted), the exception thrown should be one of the
types that derive from the &#x27;VirtualClientException&#x27; class. Additionally an appropriate &#x27;ErrorReason&#x27; should be supplied indicating the category and severity of
the error so that the profile execution logic can itself handle it appropriately. Transient error reasons are in the range of 100 - 399. If an appropriate reason
does not already exist on the &#x27;ErrorReason&#x27; enumeration, create one.</p>
<pre><code class="language-csharp">try
{
    ...
}
catch (FileNotFoundException exc)
{
    // ErrorReason.ProfileNotFound = 500

    throw new DependencyException(
      $&quot;A profile &#x27;{profileName}&#x27; does not exist on the file system by this name or path provided.&quot;,
      exc,
      ErrorReason.ProfileNotFound);
}
</code></pre>
</li>
<li>
<p><strong>Always include the original exception when raising/throwing another/custom type of exception</strong><br>
<!-- -->If an exception is caught within a given component and the developer chooses to propagate it by throwing an exception of a different
type, the original exception should be included in the new exception instance.</p>
<pre><code class="language-csharp">try
{
    // Some logic here that is looking for a specific file on the file system.
    string script = this.systemManagement.FileSystem.File.ReadAllText(filePath);
}
catch (FileNotFoundException exc)
{
    throw new WorkloadException(
        $&quot;The expected workload script &#x27;{filePath}&#x27; does not exist on the file system.&quot;,
        exc,
        ErrorReason.DependencyNotFound);
}
</code></pre>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/VirtualClient/edit/main/website/docs/developing/0070-error-handling.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/VirtualClient/docs/developing/0061-build-docker-container/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Building Docker Containers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/VirtualClient/docs/developing/0080-coding-standards/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Coding Standards</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#virtualclientexception" class="table-of-contents__link toc-highlight">VirtualClientException</a></li><li><a href="#exception-handling" class="table-of-contents__link toc-highlight">Exception Handling</a></li><li><a href="#exception-handling-recommendations" class="table-of-contents__link toc-highlight">Exception Handling Recommendations</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/VirtualClient/docs/overview/">Overview</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/microsoft/VirtualClient/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussion<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/VirtualClient/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/microsoft/VirtualClient" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://microsoft.com/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/VirtualClient/img/microsoft-logo-white-text.svg" alt="MSFT Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/VirtualClient/img/microsoft-logo-white-text.svg" alt="MSFT Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">Copyright © 2024 Microsoft.</div></div></div></footer></div>
</body>
</html>
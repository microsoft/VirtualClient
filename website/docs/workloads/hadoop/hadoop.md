# Apache Hadoop - TeraSort

## Overview
TeraSort is a benchmark used to evaluate the efficiency of distributed computing frameworks in sorting large datasets. The benchmark was introduced by the Apache Hadoop project, which is a popular open-source framework for distributed storage and processing of big data. TeraSort is designed to test the scalability and performance of distributed systems when sorting massive amounts of data.

[Official Documentation](https://hadoop.apache.org/docs/r3.3.5/hadoop-project-dist/hadoop-common/SingleCluster.html)

## Why TeraSort?

Sorting is a fundamental operation in data processing, and it becomes especially challenging when dealing with enormous datasets that cannot fit into the memory of a single machine. TeraSort addresses the need for efficient sorting in distributed environments and helps assess the performance of big data processing frameworks.

### Key Objectives of TeraSort

1. **Scalability:** TeraSort aims to evaluate how well a distributed computing framework scales when sorting data across a large number of nodes or machines.

2. **Efficiency:** The benchmark assesses the efficiency of the sorting algorithm and the overall data processing framework in terms of time and resource utilization.

3. **Fault Tolerance:** TeraSort provides insights into how well a system can handle failures or node outages during the sorting process, crucial for robustness in large-scale distributed systems.

4. **Optimization:** It encourages developers to optimize sorting algorithms and data processing techniques to achieve better performance on distributed platforms.

## How TeraSort Works

TeraSort uses a specific dataset generated with a total size of one terabyte, hence the name. The dataset consists of key-value pairs, where the key is a 10-byte long random string, and the value is a 90-byte payload. The sorting task involves ordering the key-value pairs based on the keys.

The sorting process is divided into map and reduce phases:

1. **Map Phase:** Each node in the distributed system processes a portion of the input dataset and produces a set of key-value pairs with the keys as the sorting criterion.

2. **Shuffle and Sort Phase:** The framework shuffles the intermediate key-value pairs, ensuring that all values associated with the same key are sent to the same reducer.

3. **Reduce Phase:** Each reducer processes a subset of the sorted key-value pairs, producing the final globally sorted output.

## Support for Java versions

The Hadoop 3.3.x versions support Java 8 and Java 11.

Adding the reference of the documentation here: [Supported Java Versions for Hadoop](https://cwiki.apache.org/confluence/display/HADOOP/Hadoop+Java+Versions)

## What is Being Measured?

In TeraSort, the primary metric being measured is the efficiency and performance of a distributed computing framework when sorting a massive dataset.


#### TeraGen Counters

| **Group**                | **Counter Name**                 | **Description**                                        |
|--------------------------|---------------------------------|--------------------------------------------------------|
| **File System Counters** | Number of bytes read | |
|                          | Number of bytes written | |		
|                          | Number of read operations |  |
|                          | Number of large read operations | | 
|                          | Number of write operations | |
|                          | Number of bytes read | |
|                          | Number of bytes written | | 
|                          | Number of read operations |  |
|                          | Number of large read operations | | 
|                          | Number of write operations |  |
|                          | Number of bytes read read erasure-coded | | 
| **Job Counters**         | Launched Map Tasks              | Total number of map tasks launched for TeraGen.         |
|                          | Other local map tasks                            | 2       |
|                          | Total time spent by all maps in occupied slots (ms)| 7863    |
|                          | Total time spent by all reduces in occupied slots (ms)| 0       |
|                          | Total time spent by all map tasks (ms)            | 7863    |
|                          | Total vcore-milliseconds taken by all map tasks   | 7863    |
|                          | Total megabyte-milliseconds taken by all map tasks| 8051712 |
| **Map-Reduce Framework** | Map Input Records               | Total number of input records generated by TeraGen.    |
|                          | Map Output Records              | Total number of key-value pairs emitted by TeraGen.    |
|                          | Input split bytes                              | 158             |
|                          | Spilled Records                                | 0               |
|                          | Failed Shuffles                                | 0               |
|                          | Merged Map outputs                             | 0               |
|                          | GC time elapsed (ms)                           | 45              |
|                          | CPU time spent (ms)                            | 1210            |
|                          | Physical memory (bytes) snapshot               | 439705600       |
|                          | Virtual memory (bytes) snapshot                | 5462753280      |
|                          | Total committed heap usage (bytes)             | 524288000       |
|                          | Peak Map Physical memory (bytes)              | 224296960       |
|                          | Peak Map Virtual memory (bytes)               | 2732146688      |


These counters provide insights into the generation of the input dataset by TeraGen, including the number of records, bytes processed, and the efficiency of map tasks.

#### TeraSort Counters

| **Group**                | **Counter Name**                                 | **Description** |
|--------------------------|--------------------------------------------------|-----------------|
| **File System Counters** | FILE: Number of bytes read                       | 10406           |
|                          | FILE: Number of bytes written                    | 851997          |
|                          | FILE: Number of read operations                  | 0               |
|                          | FILE: Number of large read operations            | 0               |
|                          | FILE: Number of write operations                 | 0               |
|                          | HDFS: Number of bytes read                       | 10222           |
|                          | HDFS: Number of bytes written                    | 10000           |
|                          | HDFS: Number of read operations                  | 11              |
|                          | HDFS: Number of large read operations            | 0               |
|                          | HDFS: Number of write operations                 | 2               |
|                          | HDFS: Number of bytes read erasure-coded         | 0               |
| **Job Counters**         | Launched map tasks                               | 2               |
|                          | Launched reduce tasks                            | 1               |
|                          | Data-local map tasks                             | 2               |
|                          | Total time spent by all maps in occupied slots (ms)| 9130         |
|                          | Total time spent by all reduces in occupied slots (ms)| 2844      |
|                          | Total time spent by all map tasks (ms)            | 9130           |
|                          | Total time spent by all reduce tasks (ms)         | 2844           |
|                          | Total vcore-milliseconds taken by all map tasks   | 9130           |
|                          | Total vcore-milliseconds taken by all reduce tasks| 2844           |
|                          | Total megabyte-milliseconds taken by all map tasks| 9349120        |
|                          | Total megabyte-milliseconds taken by all reduce tasks| 2912256     |
| **Map-Reduce Framework** | Map input records                                | 100             |
|                          | Map output records                               | 100             |
|                          | Map output bytes                                 | 10200           |
|                          | Map output materialized bytes                   | 10412           |
|                          | Input split bytes                                | 222             |
|                          | Combine input records                            | 0               |
|                          | Combine output records                           | 0               |
|                          | Reduce input groups                              | 100             |
|                          | Reduce shuffle bytes                             | 10412           |
|                          | Reduce input records                             | 100             |
|                          | Reduce output records                            | 100             |
|                          | Spilled Records                                  | 200             |
|                          | Shuffled Maps                                    | 2               |
|                          | Failed Shuffles                                  | 0               |
|                          | Merged Map outputs                               | 2               |
|                          | GC time elapsed (ms)                            | 71              |
|                          | CPU time spent (ms)                             | 1890            |
|                          | Physical memory (bytes) snapshot                | 875524096       |
|                          | Virtual memory (bytes) snapshot                 | 8197414912      |
|                          | Total committed heap usage (bytes)              | 786432000       |
|                          | Peak Map Physical memory (bytes)               | 324009984       |
|                          | Peak Map Virtual memory (bytes)                | 2730729472      |
|                          | Peak Reduce Physical memory (bytes)            | 229695488       |
|                          | Peak Reduce Virtual memory (bytes)             | 2741366784      |

These counters provide detailed insights into the sorting process performed by TeraSort, including the number of records, bytes processed, and resource utilization metrics.


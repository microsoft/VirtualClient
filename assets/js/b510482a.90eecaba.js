"use strict";(self.webpackChunkvirtualclient=self.webpackChunkvirtualclient||[]).push([[8588],{5870:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>a});var n=i(4848),r=i(8453);const t={},l="DiskSpd Workload Profiles",o={id:"workloads/diskspd/diskspd-profiles",title:"DiskSpd Workload Profiles",description:"The following profiles run customer-representative or benchmarking scenarios using the DiskSpd workload.",source:"@site/docs/workloads/diskspd/diskspd-profiles.md",sourceDirName:"workloads/diskspd",slug:"/workloads/diskspd/diskspd-profiles",permalink:"/VirtualClient/docs/workloads/diskspd/diskspd-profiles",draft:!1,unlisted:!1,editUrl:"https://github.com/microsoft/VirtualClient/edit/main/website/docs/workloads/diskspd/diskspd-profiles.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"DiskSpd",permalink:"/VirtualClient/docs/workloads/diskspd/"},next:{title:"Flexible IO Tester (FIO)",permalink:"/VirtualClient/docs/workloads/fio/"}},d={},a=[{value:"PERF-IO-DISKSPD.json",id:"perf-io-diskspdjson",level:2}];function c(e){const s={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"diskspd-workload-profiles",children:"DiskSpd Workload Profiles"}),"\n",(0,n.jsx)(s.p,{children:"The following profiles run customer-representative or benchmarking scenarios using the DiskSpd workload."}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"/VirtualClient/docs/workloads/diskspd/",children:"Workload Details"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"/VirtualClient/docs/guides/0220-usage-testing-disks",children:"Testing Disks"})}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"perf-io-diskspdjson",children:"PERF-IO-DISKSPD.json"}),"\n",(0,n.jsx)(s.p,{children:'Runs an high stress IO-intensive workload using the DiskSpd toolset to test performance of disks on the system. This profile is a Windows-only profile.\nThe profile runs the workload in-parallel on ALL disks that match the "DiskFilter" parameter (see below) by default.'}),"\n",(0,n.jsx)(s.p,{children:"Additionally this profile is designed to auto-scale to the number of cores on the system on which it runs. It uses a simple algorithm to determine 2 key\naspects of the workload execution."}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Total number of jobs/threads = <# of logical cores> / 2"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"Examples:  \nFor a 16-core system:\n16/2 = 16 concurrent jobs/threads per DiskSpd execution (i.e. # threads to run I/O operations against the test file concurrently).\n\nFor a 64-core system:\n64/2 = 32 concurrent jobs/threads per DiskSpd execution (i.e. # threads to run I/O operations against the test file concurrently).\n"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Total I/O depth =  512 / <Total number of jobs / threads>"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"Examples:\nFor a 16 core system:\ntotal # jobs/threads = 16/2 (above) -> 512/16 = 32\n\nFor a 64 core system:\ntotal # jobs/threads = 64/2 (above) -> 512/32 = 16\n"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://github.com/microsoft/VirtualClient/blob/main/src/VirtualClient/VirtualClient.Main/profiles/PERF-IO-DISKSPD.json",children:"Workload Profile"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Supported Platform/Architectures"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"win-x64"}),"\n",(0,n.jsx)(s.li,{children:"win-arm64"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Supported Operating Systems"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Windows 10"}),"\n",(0,n.jsx)(s.li,{children:"Windows 11"}),"\n",(0,n.jsx)(s.li,{children:"Windows Server 2016"}),"\n",(0,n.jsx)(s.li,{children:"Windows Server 2019"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Supports Disconnected Scenarios"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Yes. When the DiskSpd package is included in 'packages' directory of the Virtual Client.","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/VirtualClient/docs/dependencies/0001-install-vc-packages",children:"Installing VC Packages"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Dependencies"}),(0,n.jsx)(s.br,{}),"\n","The dependencies defined in the 'Dependencies' section of the profile itself are required in order to run the workload operations effectively."]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Internet connection."}),"\n",(0,n.jsx)(s.li,{children:"Any 'DiskFilter' parameter value used should match the set of disks desired. See the link for 'Testing Disks' above."}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Additional information on components that exist within the 'Dependencies' section of the profile can be found in the following locations:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://microsoft.github.io/VirtualClient/docs/category/dependencies/",children:"Installing Dependencies"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Scenarios"}),(0,n.jsx)(s.br,{}),"\n","The following scenarios are covered by this workload profile."]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Random Write Operations","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"4k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"8k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"12k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"16k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"1024k block size, multiple jobs/threads per disk"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["Random Read Operations","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"4k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"8k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"12k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"16k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"1024k block size, multiple jobs/threads per disk"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["Sequential Write Operations","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"4k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"8k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"12k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"16k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"1024k block size, multiple jobs/threads per disk"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["Sequential Read Operations","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"4k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"8k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"12k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"16k block size, multiple jobs/threads per disk"}),"\n",(0,n.jsx)(s.li,{children:"1024k block size, multiple jobs/threads per disk"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Profile Parameters"}),(0,n.jsx)(s.br,{}),"\n","The following parameters can be optionally supplied on the command line to modify the behaviors of the workload."]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Parameter"}),(0,n.jsx)(s.th,{children:"Purpose"}),(0,n.jsx)(s.th,{children:"Default Value"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"DiskFilter"}),(0,n.jsxs)(s.td,{children:["Optional. Filter allowing the user to select the disks on which to test.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"See the link 'Testing Disks' at the top for more details."]}),(0,n.jsx)(s.td,{children:"BiggestSize"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"DiskFillSize"}),(0,n.jsx)(s.td,{children:"Optional. Allows the user to override the default disk fill size used in the FIO profile (e.g. 500GB -> 26GB). This enables the profile to be used in scenarios where the disk size is very small (e.g. local/temp disk -> 32GB in size)."}),(0,n.jsx)(s.td,{children:"500GB"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Duration"}),(0,n.jsx)(s.td,{children:"Optional. Defines the amount of time to run each FIO scenario/action within the profile."}),(0,n.jsx)(s.td,{children:"5 minutes"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"FileSize"}),(0,n.jsx)(s.td,{children:"Optional. Allows the user to override the default file size used in the FIO profile (e.g. 496GB -> 26GB). This enables the profile to be used in scenarios where the disk size is very small (e.g. local/temp disk -> 32GB in size)."}),(0,n.jsx)(s.td,{children:"496GB"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"ProcessModel"}),(0,n.jsxs)(s.td,{children:["Optional. Defines how the FIO processes will be executed. The following are valid process models:",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"SingleProcess"}),(0,n.jsx)("br",{}),"Executes a single FIO process running 1 job targeting I/O operations against each disk. Results are separated per-disk.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"SingleProcessPerDisk"}),(0,n.jsx)("br",{}),"Executes a single FIO process for each disk with each process running 1 job targeting I/O operations against that disk (higher stress profile). Results are separated per-disk.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"SingleProcessAggregated"}),(0,n.jsx)("br",{}),"Executes a single FIO process running 1 job per disk targeting I/O operations against that disk. Results are provided as an aggregation across all disks (i.e. a rollup)."]}),(0,n.jsx)(s.td,{children:"SingleProcess"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"QueueDepth"}),(0,n.jsx)(s.td,{children:"Optional. Defines the I/O queue depth to use for the operations"}),(0,n.jsx)(s.td,{children:"512/the thread count"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"ThreadCount"}),(0,n.jsx)(s.td,{children:"Optional. Specifies the number of distinct parallel operations/threads to run per job."}),(0,n.jsx)(s.td,{children:"# logical processors / 2"})]})]})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Profile Component Parameters"}),(0,n.jsx)(s.br,{}),"\n","The following section describes the parameters used by the individual components in the profile."]}),"\n"]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Parameter"}),(0,n.jsx)(s.th,{children:"Purpose"}),(0,n.jsx)(s.th,{children:"Accepted Values"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Scenario"}),(0,n.jsx)(s.td,{children:"Scenario use to define the given action of profile. This can be used to specify exact actions to run or exclude from the profile."}),(0,n.jsx)(s.td,{children:"Any string"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"MetricsScenario"}),(0,n.jsx)(s.td,{children:'The name to use as the "scenario" for all metrics output for the particular profile action.'}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"CommandLine"}),(0,n.jsx)(s.td,{children:"The command line parameters for FIO tool set."}),(0,n.jsx)(s.td,{children:"Any Valid FIO arguments"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"DiskFilter"}),(0,n.jsx)(s.td,{children:"Filter allowing the user to select the disks on which to test."}),(0,n.jsx)(s.td,{children:"See the link 'Testing Disks' at the top for more details."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Duration"}),(0,n.jsx)(s.td,{children:"Defines the amount of time to run each FIO scenario/action within the profile."}),(0,n.jsx)(s.td,{children:"integer or time span"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"PackageName"}),(0,n.jsx)(s.td,{children:"The logical name for FIO package downloaded and that contains the toolset."}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"ProcessModel"}),(0,n.jsx)(s.td,{children:"Defines how the FIO processes will be executed."}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)("b",{children:"SingleProcess"}),(0,n.jsx)("br",{}),"Executes a single FIO process running 1 job targeting I/O operations against each disk. Results are separated per-disk.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"SingleProcessPerDisk"}),(0,n.jsx)("br",{}),"Executes a single FIO process for each disk with each process running 1 job targeting I/O operations against that disk (higher stress profile). Results are separated per-disk.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"SingleProcessAggregated"}),(0,n.jsx)("br",{}),"Executes a single FIO process running 1 job per disk targeting I/O operations against that disk. Results are provided as an aggregation across all disks (i.e. a rollup)."]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"QueueDepth"}),(0,n.jsx)(s.td,{children:"Defines the I/O queue depth to use for the operations"}),(0,n.jsx)(s.td,{children:"integer"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Tags"}),(0,n.jsx)(s.td,{children:"Tags useful for telemetry data"}),(0,n.jsx)(s.td,{children:"Any comma-separated string"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"ThreadCount"}),(0,n.jsx)(s.td,{children:"Specifies the number of distinct parallel operations/threads to run per job."}),(0,n.jsx)(s.td,{})]})]})]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Profile Runtimes"}),(0,n.jsx)(s.br,{}),"\n","See the 'Metadata' section of the profile for estimated runtimes. These timings represent the length of time required to run a single round of profile\nactions. These timings can be used to determine minimum required runtimes for the Virtual Client in order to get results. These are often estimates based on the\nnumber of system cores."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Usage Examples"}),(0,n.jsx)(s.br,{}),"\n","The following section provides a few basic examples of how to use the workload profile. See the documentation at the top on 'Testing Disks'\nfor information on how to target select disks on the system."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'# Run the workload on the system (default = largest disks)\nVirtualClient.exe --profile=PERF-IO-DISKSPD.json --system=Demo --timeout=1440 --packageStore="{BlobConnectionString|SAS Uri}"\n\n# The example above runs on the same disks as having DiskFilter=BiggestSize\nVirtualClient.exe --profile=PERF-IO-DISKSPD.json --system=Demo --timeout=1440 --packageStore="{BlobConnectionString|SAS Uri}" --parameters=DiskFilter=BiggestSize\n\n# Run the workload against the operating system disk\nVirtualClient.exe --profile=PERF-IO-DISKSPD.json --system=Demo --timeout=1440 --packageStore="{BlobConnectionString|SAS Uri}" --parameters=DiskFilter=OSDisk\n\n# Run the workload against all of the disks except the operating system disk.\nVirtualClient.exe --profile=PERF-IO-DISKSPD.json --system=Demo --timeout=1440 --packageStore="{BlobConnectionString|SAS Uri}" --parameters=DiskFilter=OSDisk:false\n\n# Run the workload on specific drives/disks\nVirtualClient.exe --profile=PERF-IO-DISKSPD.json --system=Demo --timeout=1440 --packageStore="{BlobConnectionString|SAS Uri}" --parameters=DiskFilter=DiskPath:C:\\,D:\\\n\n# A more advanced disk filter supplied\nVirtualClient.exe --profile=PERF-IO-DISKSPD.json --system=Demo --timeout=1440 --packageStore="{BlobConnectionString|SAS Uri}" --parameters=DiskFilter=OSDisk:false&smallestSize,,,DiskFillSize=26G,,,FileSize=26G\n\n# Run specific scenarios only. Each action in a profile as a \'Scenario\' name.\nVirtualClient.exe --profile=PERF-IO-DISKSPD.json --system=Demo --timeout=1440 --packageStore="{BlobConnectionString|SAS Uri}" --scenarios=RandomWrite_4k_BlockSize,RandomWrite_8k_BlockSize,RandomRead_8k_BlockSize,RandomRead_4k_BlockSize\n'})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,s,i)=>{i.d(s,{R:()=>l,x:()=>o});var n=i(6540);const r={},t=n.createContext(r);function l(e){const s=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(t.Provider,{value:s},e.children)}}}]);
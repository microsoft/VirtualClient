{
  "Description": "FIO I/O Stress Performance Workload",
  "Metadata": {
    "RecommendedMinimumExecutionTime": "02:00:00",
    "SupportedPlatforms": "linux-x64,linux-arm64,win-x64",
    "SupportedOperatingSystems": "CBL-Mariner,CentOS,Debian,RedHat,Suse,Ubuntu,Windows"
  },
  "Parameters": {
    "DiskFillSize": "10G",
    "FileSize": "10G",
    "DataIntegrityFileSize": "1G",
    "DiskFilter": "BiggestSize",
    "ProcessModel": "SingleProcess"
  },
  "Actions": [
    {
      "Type": "FioExecutor",
      "Parameters": {
        "Scenario": "DiskFill",
        "PackageName": "fio",
        "DiskFilter": "$.Parameters.DiskFilter",
        "CommandLine": "--name=disk_fill --size={DiskFillSize} --numjobs=1 --rw=write --bs=256k --iodepth=64 --direct=1 --overwrite=1 --thread",
        "TestName": "disk_fill",
        "FileName": "fio-test.dat",
        "DiskFill": true,
        "DiskFillSize": "$.Parameters.DiskFillSize",
        "ProcessModel": "SingleProcessPerDisk",
        "DeleteTestFilesOnFinish": false
      }
    },
    {
      "Type": "FioExecutor",
      "Parameters": {
        "Scenario": "FioExecutorJobFile",
        "PackageName": "fio",
        "DiskFilter": "$.Parameters.DiskFilter",
        "CommandLine": "--thread --output-format=json {JobFile}",
        "TestName": "read_write_operations",
        "JobFile": "{ScriptPath:fio}/oltp-c.jobfile",
        "ProcessModel": "$.Parameters.ProcessModel",
        "FileName": "fio-test.dat",
        "DeleteTestFilesOnFinish": false,
        "Tags": "IO,FIO,OLTP"
      }
    }
  ],
  "Dependencies": [
    {
      "Type": "FormatDisks",
      "Parameters": {
        "Scenario": "InitializeDisks"
      }
    },
    {
      "Type": "LinuxPackageInstallation",
      "Parameters": {
        "Scenario": "InstallLinuxPackages",
        "Packages-Apt": "libaio1,libaio-dev",
        "Packages-Dnf": "libaio,libaio-devel",
        "Packages-Yum": "libaio,libaio-devel",
        "Packages-Zypper": "libaio1,libaio-dev"
      }
    },
    {
      "Type": "DependencyPackageInstallation",
      "Parameters": {
        "Scenario": "InstallFIOPackage",
        "BlobContainer": "packages",
        "BlobName": "fio.3.30.0.zip",
        "PackageName": "fio",
        "Extract": true
      }
    }
  ]
}

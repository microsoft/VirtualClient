{
  "Description": "FIO I/O Stress Performance Workload",
  "Metadata": {
    "RecommendedMinimumExecutionTime": "02:00:00",
    "SupportedPlatforms": "linux-x64,linux-arm64,win-x64",
    "SupportedOperatingSystems": "CBL-Mariner,CentOS,Debian,RedHat,Suse,Ubuntu,Windows",
    "Notes": "This profile uses FIO job files (e.g. *.jobfile). The job file paths should be comma/semicolon-delimited under 'JobFiles'.",
    "Documentation": "FIO documentation: https://fio.readthedocs.io/en/latest/fio_doc.html FIO Job File documentation: https://fio.readthedocs.io/en/latest/fio_doc.html#job-file-format"
  },
  "Parameters": {
    "DiskFillSize": "10G",
    "FileSize": "10G",
    "DataIntegrityFileSize": "1G",
    "DiskFilter": "BiggestSize",
    "ProcessModel": "SingleProcess"
  },
  "Actions": [
    {
      "Type": "FioExecutor",
      "Parameters": {
        "Scenario": "DiskFill",
        "PackageName": "fio",
        "DiskFilter": "$.Parameters.DiskFilter",
        "CommandLine": "--name=disk_fill --size={DiskFillSize} --numjobs=1 --rw=write --bs=256k --iodepth=64 --direct=1 --overwrite=1 --thread",
        "TestName": "disk_fill",
        "FileName": "fio-test.dat",
        "DiskFill": true,
        "DiskFillSize": "$.Parameters.DiskFillSize",
        "ProcessModel": "SingleProcessPerDisk",
        "DeleteTestFilesOnFinish": false
      }
    },
    {
      "Type": "FioExecutor",
      "Parameters": {
        "Scenario": "FioExecutorJobFile_4K_BlockSize",
        "PackageName": "fio",
        "ProcessModel": "$.Parameters.ProcessModel",
        "TestName": "read_write_operations_4k_blocksize",
        "JobFiles": "{ScriptPath:fio}/oltp-c2.fio.jobfile",
        "FileName": "fio-test.dat",
        "DeleteTestFilesOnFinish": false,
        "DiskFilter": "$.Parameters.DiskFilter",
        "DirectIO": 1,
        "DurationSec": "180",
        "RandomReadIOPS": 270,
        "RandomWriteIOPS": 270,
        "SequentialReadIOPS": 270,
        "SequentialWriteIOPS": 270,
        "GroupReporting": "0",
        "RandomIOFileSize": "10G",
        "RandomReadBlockSize": "4K",
        "RandomReadNumJobs": 1,
        "RandomReadQueueDepth": 512,
        "RandomReadWeight": 5416,
        "RandomWriteBlockSize": "4K",
        "RandomWriteNumJobs": 1,
        "RandomWriteQueueDepth": 512,
        "RandomWriteWeight": 4255,
        "SequentialDiskCount": "1",
        "SequentialIOFileSize": "10G",
        "SequentialReadBlockSize": "4K",
        "SequentialReadNumJobs": 1,
        "SequentialReadQueueDepth": 64,
        "SequentialReadWeight": 0,
        "SequentialWriteBlockSize": "4K",
        "SequentialWriteNumJobs": 1,
        "SequentialWriteQueueDepth": 64,
        "SequentialWriteWeight": 329,
        "RandomReadIOdepth": "{calculate({RandomReadQueueDepth}/{RandomReadNumJobs})}",
        "RandomWriteIOdepth": "{calculate({RandomWriteQueueDepth}/{RandomWriteNumJobs})}",
        "SequentialReadIOdepth": "{calculate({SequentialReadQueueDepth}/{SequentialReadNumJobs})}",
        "SequentialWriteIOdepth": "{calculate({SequentialWriteQueueDepth}/{SequentialWriteNumJobs})}",
        "Tags": "IO,FIO,OLTP"
      }
    },
    {
      "Type": "FioExecutor",
      "Parameters": {
        "Scenario": "FioExecutorJobFile_8K_BlockSize",
        "PackageName": "fio",
        "ProcessModel": "$.Parameters.ProcessModel",
        "TestName": "read_write_operations_8k_blocksize",
        "JobFiles": "{ScriptPath:fio}/oltp-c2.fio.jobfile",
        "FileName": "fio-test.dat",
        "DeleteTestFilesOnFinish": false,
        "DiskFilter": "$.Parameters.DiskFilter",
        "DirectIO": 1,
        "DurationSec": "180",
        "RandomReadIOPS": 270,
        "RandomWriteIOPS": 270,
        "SequentialReadIOPS": 270,
        "SequentialWriteIOPS": 270,
        "GroupReporting": "0",
        "RandomIOFileSize": "10G",
        "RandomReadBlockSize": "8K",
        "RandomReadNumJobs": 1,
        "RandomReadQueueDepth": 512,
        "RandomReadWeight": 5416,
        "RandomWriteBlockSize": "8K",
        "RandomWriteNumJobs": 1,
        "RandomWriteQueueDepth": 512,
        "RandomWriteWeight": 4255,
        "SequentialDiskCount": "1",
        "SequentialIOFileSize": "10G",
        "SequentialReadBlockSize": "8K",
        "SequentialReadNumJobs": 1,
        "SequentialReadQueueDepth": 64,
        "SequentialReadWeight": 0,
        "SequentialWriteBlockSize": "8K",
        "SequentialWriteNumJobs": 1,
        "SequentialWriteQueueDepth": 64,
        "SequentialWriteWeight": 329,
        "RandomReadIOdepth": "{calculate({RandomReadQueueDepth}/{RandomReadNumJobs})}",
        "RandomWriteIOdepth": "{calculate({RandomWriteQueueDepth}/{RandomWriteNumJobs})}",
        "SequentialReadIOdepth": "{calculate({SequentialReadQueueDepth}/{SequentialReadNumJobs})}",
        "SequentialWriteIOdepth": "{calculate({SequentialWriteQueueDepth}/{SequentialWriteNumJobs})}",
        "Tags": "IO,FIO,OLTP"
      }
    },
    {
      "Type": "FioExecutor",
      "Parameters": {
        "Scenario": "FioExecutorJobFile_12K_BlockSize",
        "PackageName": "fio",
        "ProcessModel": "$.Parameters.ProcessModel",
        "TestName": "read_write_operations_12k_blocksize",
        "JobFiles": "{ScriptPath:fio}/oltp-c2.fio.jobfile",
        "FileName": "fio-test.dat",
        "DeleteTestFilesOnFinish": false,
        "DiskFilter": "$.Parameters.DiskFilter",
        "DirectIO": 1,
        "DurationSec": "180",
        "RandomReadIOPS": 270,
        "RandomWriteIOPS": 270,
        "SequentialReadIOPS": 270,
        "SequentialWriteIOPS": 270,
        "GroupReporting": "0",
        "RandomIOFileSize": "10G",
        "RandomReadBlockSize": "12K",
        "RandomReadNumJobs": 1,
        "RandomReadQueueDepth": 512,
        "RandomReadWeight": 5416,
        "RandomWriteBlockSize": "12K",
        "RandomWriteNumJobs": 1,
        "RandomWriteQueueDepth": 512,
        "RandomWriteWeight": 4255,
        "SequentialDiskCount": "1",
        "SequentialIOFileSize": "10G",
        "SequentialReadBlockSize": "12K",
        "SequentialReadNumJobs": 1,
        "SequentialReadQueueDepth": 64,
        "SequentialReadWeight": 0,
        "SequentialWriteBlockSize": "12K",
        "SequentialWriteNumJobs": 1,
        "SequentialWriteQueueDepth": 64,
        "SequentialWriteWeight": 329,
        "RandomReadIOdepth": "{calculate({RandomReadQueueDepth}/{RandomReadNumJobs})}",
        "RandomWriteIOdepth": "{calculate({RandomWriteQueueDepth}/{RandomWriteNumJobs})}",
        "SequentialReadIOdepth": "{calculate({SequentialReadQueueDepth}/{SequentialReadNumJobs})}",
        "SequentialWriteIOdepth": "{calculate({SequentialWriteQueueDepth}/{SequentialWriteNumJobs})}",
        "Tags": "IO,FIO,OLTP"
      }
    },
    {
      "Type": "FioExecutor",
      "Parameters": {
        "Scenario": "FioExecutorJobFile_16K_BlockSize",
        "PackageName": "fio",
        "ProcessModel": "$.Parameters.ProcessModel",
        "TestName": "read_write_operations_16k_blocksize",
        "JobFiles": "{ScriptPath:fio}/oltp-c2.fio.jobfile",
        "FileName": "fio-test.dat",
        "DeleteTestFilesOnFinish": false,
        "DiskFilter": "$.Parameters.DiskFilter",
        "DirectIO": 1,
        "DurationSec": "180",
        "RandomReadIOPS": 270,
        "RandomWriteIOPS": 270,
        "SequentialReadIOPS": 270,
        "SequentialWriteIOPS": 270,
        "GroupReporting": "0",
        "RandomIOFileSize": "10G",
        "RandomReadBlockSize": "16K",
        "RandomReadNumJobs": 1,
        "RandomReadQueueDepth": 512,
        "RandomReadWeight": 5416,
        "RandomWriteBlockSize": "16K",
        "RandomWriteNumJobs": 1,
        "RandomWriteQueueDepth": 512,
        "RandomWriteWeight": 4255,
        "SequentialDiskCount": "1",
        "SequentialIOFileSize": "10G",
        "SequentialReadBlockSize": "16K",
        "SequentialReadNumJobs": 1,
        "SequentialReadQueueDepth": 64,
        "SequentialReadWeight": 0,
        "SequentialWriteBlockSize": "16K",
        "SequentialWriteNumJobs": 1,
        "SequentialWriteQueueDepth": 64,
        "SequentialWriteWeight": 329,
        "RandomReadIOdepth": "{calculate({RandomReadQueueDepth}/{RandomReadNumJobs})}",
        "RandomWriteIOdepth": "{calculate({RandomWriteQueueDepth}/{RandomWriteNumJobs})}",
        "SequentialReadIOdepth": "{calculate({SequentialReadQueueDepth}/{SequentialReadNumJobs})}",
        "SequentialWriteIOdepth": "{calculate({SequentialWriteQueueDepth}/{SequentialWriteNumJobs})}",
        "Tags": "IO,FIO,OLTP"
      }
    },
    {
      "Type": "FioExecutor",
      "Parameters": {
        "Scenario": "FioExecutorJobFile_1024K_BlockSize",
        "PackageName": "fio",
        "ProcessModel": "$.Parameters.ProcessModel",
        "TestName": "read_write_operations_1024k_blocksize",
        "JobFiles": "{ScriptPath:fio}/oltp-c2.fio.jobfile",
        "FileName": "fio-test.dat",
        "DeleteTestFilesOnFinish": false,
        "DiskFilter": "$.Parameters.DiskFilter",
        "DirectIO": 1,
        "DurationSec": "180",
        "RandomReadIOPS": 270,
        "RandomWriteIOPS": 270,
        "SequentialReadIOPS": 270,
        "SequentialWriteIOPS": 270,
        "GroupReporting": "0",
        "RandomIOFileSize": "10G",
        "RandomReadBlockSize": "1024K",
        "RandomReadNumJobs": 1,
        "RandomReadQueueDepth": 512,
        "RandomReadWeight": 5416,
        "RandomWriteBlockSize": "1024K",
        "RandomWriteNumJobs": 1,
        "RandomWriteQueueDepth": 512,
        "RandomWriteWeight": 4255,
        "SequentialDiskCount": "1",
        "SequentialIOFileSize": "10G",
        "SequentialReadBlockSize": "1024K",
        "SequentialReadNumJobs": 1,
        "SequentialReadQueueDepth": 64,
        "SequentialReadWeight": 0,
        "SequentialWriteBlockSize": "1024K",
        "SequentialWriteNumJobs": 1,
        "SequentialWriteQueueDepth": 64,
        "SequentialWriteWeight": 329,
        "RandomReadIOdepth": "{calculate({RandomReadQueueDepth}/{RandomReadNumJobs})}",
        "RandomWriteIOdepth": "{calculate({RandomWriteQueueDepth}/{RandomWriteNumJobs})}",
        "SequentialReadIOdepth": "{calculate({SequentialReadQueueDepth}/{SequentialReadNumJobs})}",
        "SequentialWriteIOdepth": "{calculate({SequentialWriteQueueDepth}/{SequentialWriteNumJobs})}",
        "Tags": "IO,FIO,OLTP"
      }
    }
  ],
  "Dependencies": [
    {
      "Type": "FormatDisks",
      "Parameters": {
        "Scenario": "InitializeDisks"
      }
    },
    {
      "Type": "LinuxPackageInstallation",
      "Parameters": {
        "Scenario": "InstallLinuxPackages",
        "Packages-Apt": "libaio1,libaio-dev",
        "Packages-Dnf": "libaio,libaio-devel",
        "Packages-Yum": "libaio,libaio-devel",
        "Packages-Zypper": "libaio1,libaio-dev"
      }
    },
    {
      "Type": "DependencyPackageInstallation",
      "Parameters": {
        "Scenario": "InstallFIOPackage",
        "BlobContainer": "packages",
        "BlobName": "fio.3.30.0.zip",
        "PackageName": "fio",
        "Extract": true
      }
    }
  ]
}

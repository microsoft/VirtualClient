{
    "Description": "SPEC CPU 2017 Floating Point (SPECspeed) Benchmark Workload",
    "MinimumExecutionInterval": "00:05:00",
    "MinimumRequiredExecutionTime": "02:00:00",
    "Metadata": {
        "RecommendedMinimumExecutionTime": "(4-cores)=02:00:00,(16-cores)=06:00:00,(64-cores)=12:00:00",
        "SupportedPlatforms": "linux-x64,linux-arm64,win-x64,win-arm64",
        "SupportedOperatingSystems": "CBL-Mariner,CentOS,Debian,RedHat,Suse,Ubuntu,Windows",
        "Notes": "Using a private package 'speccpu.2017.1.1.9-danielbowers.zip' to enable support for speccpu on Ubuntu 24",
        "Limitations": "The following benchmarks don't work on Windows: 607, 621, 627, 628, 638, 649"
    },
    "Parameters": {
        "CompilerVersion": "",
        "Iterations": 2,
        "RunPeak": false,
        "Threads": "{LogicalCoreCount}",
        "Copies": "{LogicalCoreCount}",
        "Benchmarks": "{calculate(\"{Platform}\".StartsWith(\"linux\") ? \"fpspeed\" : \"603 619 644 654\")}",
        "BaseOptimizingFlags": "-g -O3 -march=native -frecord-gcc-switches",
        "PeakOptimizingFlags": "-g -Ofast -march=native -flto -frecord-gcc-switches"
    },
    "Actions": [
        {
            "Type": "SpecCpuExecutor",
            "Parameters": {
                "Scenario": "ExecuteSPECBenchmark",
                "Iterations": "$.Parameters.Iterations",
                "SpecProfile": "fpspeed",
                "Benchmarks": "$.Parameters.Benchmarks",
                "PackageName": "speccpu2017",
                "RunPeak": "$.Parameters.RunPeak",
                "Threads": "$.Parameters.Threads",
                "Copies": "$.Parameters.Copies",
                "BaseOptimizingFlags": "$.Parameters.BaseOptimizingFlags",
                "PeakOptimizingFlags": "$.Parameters.PeakOptimizingFlags"
            }
        }
    ],
    "Dependencies": [
        {
            "Type": "ChocolateyInstallation",
            "Parameters": {
                "Scenario": "InstallChocolatey",
                "PackageName": "chocolatey",
                "SupportedPlatforms": "win-x64,win-arm64"
            }
        },
        {
            "Type": "ChocolateyPackageInstallation",
            "Parameters": {
                "Scenario": "InstallCompiler",
                "PackageName": "chocolatey",
                "Packages": "cygwin",
                "SupportedPlatforms": "win-x64,win-arm64"
            }
        },
        {
            "Type": "CompilerInstallation",
            "Parameters": {
                "Scenario": "InstallCompiler",
                "CompilerVersion": "$.Parameters.CompilerVersion",
                "CygwinPackages": "gcc-g++,gcc-fortran,gcc-core,libiconv-devel"
            }
        },
        {
            "Type": "DependencyPackageInstallation",
            "Parameters": {
                "Scenario": "InstallSPECcpuPackage",
                "BlobContainer": "packages",
                "BlobName": "speccpu.2017.1.1.9-danielbowers.zip",
                "PackageName": "speccpu2017",
                "Extract": true
            }
        }
    ]
}

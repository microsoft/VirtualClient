{
    "Description": "Sysbench OLTP MySQL Database Server Performance Workload",
    "MinimumExecutionInterval": "00:01:00",
    "Metadata": {
        "RecommendedMinimumExecutionTime": "04:00:00",
        "SupportedPlatforms": "linux-x64,linux-arm64",
        "SupportedOperatingSystems": "Debian,Ubuntu"
    },
    "Parameters": {
        "DatabaseName": "sbtest",
        "DatabaseScenario": "Default",
        "Duration": "00:05:00",
        "PackageName": "sysbench"
    },
    "Actions": [
        {
            "Type": "SysbenchConfiguration",
            "Parameters": {
                "Scenario": "PopulateMySQLDatabase",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "PackageName": "$.Parameters.PackageName",
                "Role": "Server"
            }
        },
        {
            "Type": "SysbenchServerExecutor",
            "Parameters": {
                "Scenario": "StartMySQLServer",
                "Role": "Server"
            }
        },
        {
            "Type": "SysbenchClientExecutor",
            "Parameters": {
                "Scenario": "oltp_read_write",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "Duration": "$.Parameters.Duration",
                "Workload": "oltp_read_write",
                "PackageName": "$.Parameters.PackageName",
                "Role": "Client"
            }
        },
        {
            "Type": "SysbenchClientExecutor",
            "Parameters": {
                "Scenario": "oltp_read_only",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "Duration": "$.Parameters.Duration",
                "Workload": "oltp_read_only",
                "PackageName": "$.Parameters.PackageName",
                "Role": "Client"
            }
        },
        {
            "Type": "SysbenchClientExecutor",
            "Parameters": {
                "Scenario": "oltp_write_only",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "Duration": "$.Parameters.Duration",
                "Workload": "oltp_write_only",
                "PackageName": "$.Parameters.PackageName",
                "Role": "Client"
            }
        },
        {
            "Type": "SysbenchClientExecutor",
            "Parameters": {
                "Scenario": "oltp_delete",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "Duration": "$.Parameters.Duration",
                "Workload": "oltp_delete",
                "PackageName": "$.Parameters.PackageName",
                "Role": "Client"
            }
        },
        {
            "Type": "SysbenchClientExecutor",
            "Parameters": {
                "Scenario": "oltp_insert",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "Duration": "$.Parameters.Duration",
                "Workload": "oltp_insert",
                "PackageName": "$.Parameters.PackageName",
                "Role": "Client"
            }
        },
        {
            "Type": "SysbenchClientExecutor",
            "Parameters": {
                "Scenario": "oltp_update_index",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "Duration": "$.Parameters.Duration",
                "Workload": "oltp_update_index",
                "PackageName": "$.Parameters.PackageName",
                "Role": "Client"
            }
        },
        {
            "Type": "SysbenchClientExecutor",
            "Parameters": {
                "Scenario": "oltp_update_non_index",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "Duration": "$.Parameters.Duration",
                "Workload": "oltp_update_non_index",
                "PackageName": "sysbench",
                "Role": "Client"
            }
        },
        {
            "Type": "SysbenchClientExecutor",
            "Parameters": {
                "Scenario": "select_random_points",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "Duration": "$.Parameters.Duration",
                "Workload": "select_random_points",
                "PackageName": "$.Parameters.PackageName",
                "Role": "Client"
            }
        },
        {
            "Type": "SysbenchClientExecutor",
            "Parameters": {
                "Scenario": "select_random_ranges",
                "DatabaseName": "$.Parameters.DatabaseName",
                "DatabaseScenario": "$.Parameters.DatabaseScenario",
                "Duration": "$.Parameters.Duration",
                "Workload": "select_random_ranges",
                "PackageName": "$.Parameters.PackageName",
                "Role": "Client"
            }
        }
    ],
    "Dependencies": [
        {
            "Type": "FormatDisks",
            "Parameters": {
                "Scenario": "FormatServerDisks",
                "Role": "Server"
            }
        },
        {
            "Type": "MountDisks",
            "Parameters": {
                "Scenario": "MountServerDisks",
                "Role": "Server"
            }
        },
        {
            "Type": "LinuxPackageInstallation",
            "Parameters": {
                "Scenario": "InstallLinuxPackages",
                "Packages": "make, automake, libtool, pkg-config",
                "Packages-Apt": "libaio-dev, libmysqlclient-dev, libssl-dev",
                "Packages-Dnf": "libaio-devel, mariadb-devel, openssl-devel",
                "Packages-Yum": "libaio-devel, mariadb-devel, openssl-devel",
                "Packages-Zypper": "libaio-dev, libmysqlclient-devel, openssl-devel"
            }
        },
        {
            "Type": "LinuxPackageInstallation",
            "Parameters": {
                "Scenario": "InstallLinuxPackages",
                "Packages": "mysql-server",
                "Role": "Server"
            }
        },
        {
            "Type": "MySQLServerConfiguration",
            "Parameters": {
                "Scenario": "StartMySQLServer",
                "Action": "StartServer",
                "Role": "Server"
            }
        },
        {
            "Type": "MySQLServerConfiguration",
            "Parameters": {
                "Scenario": "CreateMySQLDatabase",
                "Action": "CreateDatabase",
                "DatabaseName": "$.Parameters.DatabaseName",
                "Role": "Server"
            }
        },
        {
            "Type": "MySQLServerConfiguration",
            "Parameters": {
                "Scenario": "RaiseMySQLMaxStatements",
                "Action": "RaisedMaxStatementCount",
                "Role": "Server"
            }
        },
        {
            "Type": "MySQLServerConfiguration",
            "Parameters": {
                "Scenario": "RaiseMySQLMaxConnections",
                "Action": "RaisedMaxConnectionCount",
                "Role": "Server"
            }
        },
        {
            "Type": "MySQLServerConfiguration",
            "Parameters": {
                "Scenario": "ConfigureMySQLNetwork",
                "Action": "ConfigureNetwork",
                "Role": "Server"
            }
        },
        {
            "Type": "MySQLServerConfiguration",
            "Parameters": {
                "Scenario": "CreateMySQLUser",
                "Action": "CreateUser",
                "DatabaseName": "$.Parameters.DatabaseName",
                "Role": "Server"
            }
        },
        {
            "Type": "MySQLServerConfiguration",
            "Parameters": {
                "Scenario": "SetMySQLInnodbDirectories",
                "Action": "SetInnodbDirectories",
                "Role": "Server"
            }
        },
        {
            "Type": "GitRepoClone",
            "Parameters": {
                "Scenario": "CloneSysbenchRepo",
                "RepoUri": "https://github.com/akopytov/sysbench.git",
                "PackageName": "sysbench"
            }
        },
        {
            "Type": "ApiServer",
            "Parameters": {
                "Scenario": "StartAPIServer",
                "Role": "Server"
            }
        }
    ]
}